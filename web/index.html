<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WELL Hackathon 2026 | Patient Intelligence Explorer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Plus+Jakarta+Sans:wght@500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="page-bg"></div>

  <header class="hero">
    <div class="hero-left">
      <p class="hero-kicker">WELL HEALTH TECHNOLOGIES</p>
      <h1>Patient Intelligence Explorer</h1>
      <p class="hero-sub">Hackathon 2026 · Built by <strong>Neural Ninjas</strong></p>
      <p class="hero-mission">Positively impacting health outcomes through data-informed clinical context.</p>
    </div>

    <div class="hero-right">
      <div class="badge">TSX: WELL</div>
      <button id="toggleAllMask" class="action-btn" type="button" aria-pressed="false">
        <span class="eye-icon" aria-hidden="true"></span>
        <span class="toggle-label">Reveal All Sensitive Data</span>
      </button>
    </div>
  </header>

  <section class="stats" id="stats"></section>

  <section class="layout">
    <aside class="panel filters">
      <div class="filter-head">
        <h2>Smart Filters</h2>
        <button id="clearFilters" type="button" class="link-btn">Clear</button>
      </div>

      <label class="search-wrapper">
        Semantic Search <span class="search-hint">(use @prefix for keyword lookup)</span>
        <input id="q" type="search" placeholder="asthma in children, diabetic eye care, @john" />
        <div id="esDropdown" class="es-dropdown"></div>
      </label>

      <div class="filter-grid">
        <label>City
          <select id="city"><option value="">All</option></select>
        </label>
        <label>Province
          <select id="province"><option value="">All</option></select>
        </label>
        <label>Sex / Gender
          <select id="sex_gender"><option value="">All</option></select>
        </label>
        <label>Ethnicity
          <select id="ethnicity"><option value="">All</option></select>
        </label>
        <label>Known Allergy
          <select id="known_allergy">
            <option value="all">All</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </label>
        <label>Organization
          <select id="organization"><option value="">All</option></select>
        </label>
        <label>Practitioner
          <select id="practitioner"><option value="">All</option></select>
        </label>
        <label>Encounter Type
          <select id="encounter_type"><option value="">All</option></select>
        </label>
        <label>Care Setting
          <select id="setting"><option value="">All</option></select>
        </label>
      </div>

      <div class="range-row">
        <label>Min Age
          <input id="min_age" type="number" min="0" max="120" placeholder="0" />
        </label>
        <label>Max Age
          <input id="max_age" type="number" min="0" max="120" placeholder="120" />
        </label>
      </div>

      <div class="range-row">
        <label>Encounter From
          <input id="date_from" type="date" />
        </label>
        <label>Encounter To
          <input id="date_to" type="date" />
        </label>
      </div>
    </aside>

    <main>
      <div class="results-head">
        <h2 id="resultTitle">Patients</h2>
        <p id="resultMeta"></p>
      </div>
      <section id="results" class="results"></section>
    </main>
  </section>

  <template id="card-template">
    <article class="panel patient-card">
      <div class="card-top">
        <div>
          <h3 class="name"></h3>
          <p class="meta"></p>
        </div>
        <button class="eye-btn" type="button" aria-pressed="false" title="Reveal sensitive fields">
          <span class="eye-icon" aria-hidden="true"></span>
        </button>
      </div>

      <div class="chips"></div>

      <div class="kv-grid">
        <div>
          <p class="label">Date of Birth</p>
          <p class="value dob sensitive"></p>
        </div>
        <div>
          <p class="label">Address</p>
          <p class="value address sensitive"></p>
        </div>
        <div>
          <p class="label">Primary Allergies</p>
          <p class="value allergies sensitive"></p>
        </div>
        <div>
          <p class="label">Medication Summary</p>
          <p class="value meds sensitive"></p>
        </div>
      </div>

      <div class="card-actions">
        <button class="link-btn view-encounters-btn" type="button">View Encounter Timeline</button>
      </div>

      <details>
        <summary>Expanded Context</summary>
        <div class="detail-grid">
          <p><strong>Problem List:</strong> <span class="problem-list"></span></p>
          <p><strong>Plan:</strong> <span class="plan"></span></p>
          <p><strong>Organizations:</strong> <span class="orgs"></span></p>
          <p><strong>Practitioners:</strong> <span class="practs"></span></p>
          <p><strong>Last Encounter:</strong> <span class="last-encounter"></span></p>
          <p><strong>Recent Reasons:</strong> <span class="enc-reasons sensitive"></span></p>
        </div>
      </details>
    </article>
  </template>

  <dialog id="encounterDialog" class="encounter-dialog">
    <form method="dialog" class="dialog-shell">
      <header class="dialog-head">
        <div>
          <p class="dialog-kicker">Patient Encounter Detail</p>
          <h3 id="dialogPatientName"></h3>
          <p id="dialogPatientMeta" class="dialog-meta"></p>
        </div>
        <button type="submit" class="eye-btn" aria-label="Close dialog">✕</button>
      </header>

      <section class="dialog-snapshot">
        <div>
          <p class="label">Problem List</p>
          <p id="dialogProblemList" class="value"></p>
        </div>
        <div>
          <p class="label">Allergies</p>
          <p id="dialogAllergies" class="value sensitive"></p>
        </div>
        <div>
          <p class="label">Medication Summary</p>
          <p id="dialogMeds" class="value sensitive"></p>
        </div>
      </section>

      <section id="dialogEncounterList" class="dialog-encounters"></section>
    </form>
  </dialog>

  <!-- Chat Widget -->
  <button id="chatToggle" class="chat-toggle" type="button" aria-label="Open AI assistant">
    <svg class="chat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
    </svg>
    <svg class="chat-close-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
    </svg>
  </button>

  <aside id="chatPanel" class="chat-panel" aria-hidden="true">
    <header class="chat-header">
      <div>
        <h3>Clinical AI Assistant</h3>
        <p>Ask questions about patient records</p>
      </div>
      <button id="chatClear" class="chat-clear-btn" type="button" title="Clear chat">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
      </button>
    </header>

    <div id="chatMessages" class="chat-messages">
      <div class="chat-welcome">
        <p>Hi! I can search patient records, answer clinical questions, and generate charts from encounter data.</p>
        <p class="chat-welcome-hint">Try: "Which patients have diabetes?" or "Chart A1C for Eleanor Voss"</p>
      </div>
    </div>

    <form id="chatForm" class="chat-input-area">
      <input id="chatInput" type="text" placeholder="Ask about patients, conditions, metrics…" autocomplete="off" />
      <button type="submit" class="chat-send-btn" aria-label="Send message">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
        </svg>
      </button>
      <div id="chatMentionList" class="chat-mention-list" hidden></div>
    </form>
  </aside>

  <script src="/app.js" defer></script>
</body>
</html>
